/*
router.get("/get-all", (req, res) => {
    let sql = "select * from post";
    dbConnection.query(sql, (err, queryResult) => {
      if (err) {
        console.log(err);
        res.status(500).send("Internal Server Error");
      } else {
        console.log("products : ", queryResult);
        queryResult.forEach((r, index) => {
          let sql = `select * from category where id_category = ${r.id_category}`;
          dbConnection.query(sql, (err, rslt) => {
            if (err) {
              console.log(err);
              res.status(500).send("Internal Server Error");
            } else {
              if (rslt.length > 0) {
                queryResult[index].id_category = rslt[0];
              }
              //in the last iteration send the query result
              if (index === queryResult.length - 1) {
                res.status(200).json(queryResult);
              }
            }
          });
        });
      }
    });
  });*/
/*  
router.get("/get-all", (req, res) => {
    let sql = "select * from post";
    dbConnection.query(sql, (err, queryResult) => {
      if (err) {
        console.log(err);
      } else {
        let counter = 0;
        const fetchCategories = () => {
          if (counter < queryResult.length) {
            let post = queryResult[counter];
            let categorySql = `select * from category where id_category = ${post.id_category}`;
            dbConnection.query(categorySql, (err, categoryResult) => {
              if (err) {
                console.log(err);
              } else {
                if (categoryResult.length > 0) {
                  queryResult[counter].id_category = categoryResult[0];
                }
                counter++;
                fetchCategories(); // Call recursively for the next post
              }
            });
          } else {
            res.status(200).json(queryResult);
          }
        };
        fetchCategories(); // Start fetching categories
      }
    });
  });
  */